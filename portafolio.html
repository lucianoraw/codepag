<!DOCTYPE html>
<html>
<head>
  <title>Portafolio</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <style>
    .gallery {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 20px;
    }
    
    .gallery-item {
      width: 200px;
      height: 200px;
      background-size: cover;
      background-position: center;
      margin: 10px;
      position: relative;
      cursor: pointer;
    }
    
    .lightbox {
      background-color: rgba(0, 0, 0, 0.8);
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
      align-items: center;
      justify-content: center;
    }
    
    .lightbox-image {
      max-width: 80%;
      max-height: 80%;
    }
    
    .lightbox-caption {
      color: #fff;
      margin-top: 10px;
      text-align: center;
    }
    
    .edit-button {
      position: absolute;
      top: 5px;
      right: 5px;
      background-color: #fff;
      color: #000;
      border: none;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
    
    .edit-modal {
      background-color: rgba(0, 0, 0, 0.8);
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
      align-items: center;
      justify-content: center;
    }
    
    .edit-modal-content {
      background-color: #fff;
      padding: 20px;
      border-radius: 5px;
      max-width: 400px;
      text-align: center;
    }
    
    .edit-description-input {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
    }
    
    .edit-details-textarea {
      width: 100%;
      height: 100px;
      padding: 10px;
      margin-bottom: 10px;
    }
    
    .edit-buttons {
      text-align: center;
    }
    
    .edit-save-button {
      background-color: #4caf50;
      color: #fff;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    
    .edit-cancel-button {
      background-color: #f44336;
      color: #fff;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="gallery">
    <div class="gallery-item" style="background-image: url('https://raw.githubusercontent.com/lucianoraw/pagina/main/portafolio/mgolfgti.JPG');" data-description="Fabricante: Volkswagen<br>Modelo: Golf GTI<br>Ubicación: Autódromo Codegua, Chile<br>Meet: NM Fest 2022">
      <button class="edit-button">Editar</button>
    </div>
    <div class="gallery-item" style="background-image: url('https://raw.githubusercontent.com/lucianoraw/pagina/main/portafolio/mfocusst.JPG');" data-description="Fabricante: Ford<br>Modelo: Focus ST<br>Ubicación: Autódromo Codegua, Chile<br>Meet: NM Fest 2022">
      <button class="edit-button">Editar</button>
    </div>
    <div class="gallery-item" style="background-image: url('https://raw.githubusercontent.com/lucianoraw/pagina/main/portafolio/megolfr20.JPG');" data-description="Fabricante: Volkswagen<br>Modelo: Golf R20<br>Ubicación: Autódromo Codegua, Chile<br>Meet: NM Fest 2022">
      <button class="edit-button">Editar</button>
    </div>
  </div>

  <div class="lightbox">
    <span class="lightbox-close">&times;</span>
    <img class="lightbox-image" src="" alt="">
    <div class="lightbox-caption"></div>
    <button class="edit-button lightbox-edit-button">Editar</button>
  </div>

  <div class="edit-modal">
    <div class="edit-modal-content">
      <h3>Editar descripción</h3>
      <input class="edit-description-input" type="text" placeholder="Descripción">
      <textarea class="edit-details-textarea" placeholder="Detalles"></textarea>
      <div class="edit-buttons">
        <button class="edit-save-button">Guardar</button>
        <button class="edit-cancel-button">Cancelar</button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
    const galleryItems = document.querySelectorAll('.gallery-item');
    const lightbox = document.querySelector('.lightbox');
    const lightboxImage = document.querySelector('.lightbox-image');
    const lightboxCaption = document.querySelector('.lightbox-caption');
    const lightboxClose = document.querySelector('.lightbox-close');
    const editModal = document.querySelector('.edit-modal');
    const editDescriptionInput = document.querySelector('.edit-description-input');
    const editDetailsTextarea = document.querySelector('.edit-details-textarea');
    const editButtons = document.querySelector('.edit-buttons');
    const editSaveButton = document.querySelector('.edit-save-button');
    const editCancelButton = document.querySelector('.edit-cancel-button');
    let currentItem;

    // Mostrar el lightbox con la imagen y la descripción
    function showLightbox(imageSrc, description) {
      lightboxImage.src = imageSrc;
      lightboxCaption.innerHTML = description;
      lightbox.classList.add('open');
    }

    // Cerrar el lightbox
    function closeLightbox() {
      lightbox.classList.remove('open');
    }

    // Mostrar el modal de edición con la descripción actual
    function showEditModal(description) {
      editDescriptionInput.value = description;
      editModal.classList.add('open');
    }

    // Cerrar el modal de edición
    function closeEditModal() {
      editModal.classList.remove('open');
    }

    // Agregar eventos de clic a las imágenes de la galería
    galleryItems.forEach((item) => {
      const editButton = item.querySelector('.edit-button');
      const editButtonLightbox = item.querySelector('.lightbox-edit-button');

      item.addEventListener('click', () => {
        const imageSrc = item.style.backgroundImage.slice(5, -2);
        const description = item.dataset.description;
        showLightbox(imageSrc, description);
      });

      editButton.addEventListener('click', (event) => {
        event.stopPropagation();
        currentItem = item;
        const description = item.dataset.description;
        showEditModal(description);
      });

      editButtonLightbox.addEventListener('click', (event) => {
        event.stopPropagation();
        currentItem = item;
        const description = item.dataset.description;
        showEditModal(description);
      });
    });

    // Evento de clic en el botón de cerrar del lightbox
    lightboxClose.addEventListener('click', closeLightbox);

    // Evento de clic fuera del lightbox para cerrarlo
    lightbox.addEventListener('click', (event) => {
      if (event.target === lightbox) {
        closeLightbox();
      }
    });

    // Evento de clic en el botón de editar del modal
    editSaveButton.addEventListener('click', () => {
      const newDescription = editDescriptionInput.value;
      const newDetails = editDetailsTextarea.value;

      currentItem.dataset.description = newDescription;
      currentItem.querySelector('.lightbox-caption').innerHTML = newDescription;

      closeEditModal();
    });

    // Evento de clic en el botón de cancelar del modal
    editCancelButton.addEventListener('click', closeEditModal);
  </script>
</body>
</html>
